-- –ó–ê–î–ê–ù–ò–ï 1

-- 1. –°–æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç –∏–º—è –≤–∏–¥–∞ —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º id. –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –±—É–∫–≤–µ ¬´–ú¬ª.

select species_name from species where species_id=(select min(species_id) from species);

/* 2. –°–æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç –∏–º—è –≤–∏–¥–∞ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π –±–æ–ª–µ–µ 1800.
–†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –±—É–∫–≤–µ ¬´–ë¬ª.*/

select species_name from species where species_amount>1800;

/* 3. –°–æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç –∏–º—è –≤–∏–¥–∞, –Ω–∞—á–∏–Ω–∞—é—â–µ–≥–æ—Å—è –Ω–∞ ¬´–ø¬ª –∏ –æ—Ç–Ω–æ—Å—è—â–µ–≥–æ—Å—è –∫ —Ç–∏–ø—É —Å type_id = 5.
–†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –±—É–∫–≤–µ ¬´–û¬ª. */

select species_name from species where type_id = 5 and species_name like '–ø%';

/* 4. –°–æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç –∏–º—è –≤–∏–¥–∞, –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–µ–≥–æ—Å—è –Ω–∞ ¬´—Å–∞¬ª –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π –∫–æ—Ç–æ—Ä–æ–≥–æ —Ä–∞–≤–Ω–æ 5.
–†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –±—É–∫–≤–µ –í.*/

select species_name from species where species_amount=5 or species_name='%—Å–∞';

-- –ó–ê–î–ê–ù–ò–ï 2

-- 1. –°–æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç –∏–º—è –≤–∏–¥–∞, –ø–æ—è–≤–∏–≤—à–µ–≥–æ—Å—è –Ω–∞ —É—á–µ—Ç–µ –≤ 2023 –≥–æ–¥—É. –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –±—É–∫–≤–µ ¬´–´¬ª.

-- "–ö—Ä–∏–≤–æ–π" —Å–ø–æ—Å–æ–± (–∏–∑ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –î–ó) + –æ—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–µ "to_char" ü§Æ

select species_name, to_char(date_start, 'YYYY')
from species
where to_char(date_start, 'YYYY') ='2023';

-- –ê–¥–µ–∫–≤–∞—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± 

select species_name
from species
where EXTRACT(YEAR from date_start) = 2023;

/* 2. –°–æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ (status = absent) –≤–∏–¥–∞, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –≤–º–µ—Å—Ç–µ —Å place_id = 3.
–†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –±—É–∫–≤–µ ¬´–°¬ª.*/

select s.species_name
from species as s join species_in_places as p
on s.species_id = p.species_id
where s.species_status='absent' and p.place_id=3;

/* 3.–°–æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–∞, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –≤ –¥–æ–º–µ –∏ –ø–æ—è–≤–∏–≤—à–µ–≥–æ—Å—è –≤ –º–∞–µ,
–∞ —Ç–∞–∫–∂–µ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π –≤–∏–¥–∞. –ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–∞ –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –±—É–∫–≤–µ ¬´–ü¬ª.*/

select s.species_name, s.species_amount
from species as s join (places as p join species_in_places as sip on p.place_id = sip.place_id) as x
on s.species_id=x.species_id
where x.place_name='–¥–æ–º' and extract(MONTH from s.date_start) =5;

/* 4. –°–æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–∞, —Å–æ—Å—Ç–æ—è—â–µ–≥–æ –∏–∑ –¥–≤—É—Ö —Å–ª–æ–≤ (—Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–±–µ–ª).
–†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∑–Ω–∞–∫—É !. */

select species_name
from species
where species_name like '% %';

-- –ó–ê–î–ê–ù–ò–ï 3

-- 1. –°–æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç –∏–º—è –≤–∏–¥–∞, –ø–æ—è–≤–∏–≤—à–µ–≥–æ—Å—è —Å –º–∞–ª—ã—à–æ–º –≤ –æ–¥–∏–Ω –¥–µ–Ω—å. –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –±—É–∫–≤–µ ¬´–ß¬ª.

select species_name
from species
where species_name !='–º–∞–ª—ã—à' and date_start=(select date_start from species where species_name='–º–∞–ª—ã—à');

/* 2. –°–æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–∞, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –≤ –∑–¥–∞–Ω–∏–∏ —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π –ø–ª–æ—â–∞–¥—å—é.
–†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –±—É–∫–≤–µ ¬´–ñ¬ª.*/

select species_name
from species as s join (places as p join species_in_places as sip on p.place_id = sip.place_id) as x
on s.species_id=x.species_id
where x.place_size= (select max(place_size) from places
					 where places.place_name not in ('—Ä–µ–∫–∞', '–ª–µ—Å', '—Å–∞–¥')) and x.place_name not in ('—Ä–µ–∫–∞', '–ª–µ—Å', '—Å–∞–¥');

/* 3. –°–æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å/–∑–∞–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–π–¥—É—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–∞, –æ—Ç–Ω–æ—Å—è—â–µ–≥–æ—Å—è –∫ 5-–π –ø–æ —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏ –≥—Ä—É–ø–ø–µ –ø—Ä–æ–∂–∏–≤–∞—é—â–µ–π –¥–æ–º–∞.
–†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –±—É–∫–≤–µ ¬´–®¬ª.

 –û–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º —Å–ø—Ä–∞–≤–∏–ª—Å—è */

select species_name
from species as s join (places as p join species_in_places as sip on p.place_id = sip.place_id) as x
on s.species_id=x.species_id
where x.place_name='–¥–æ–º'
order by s.species_amount desc
limit 1
offset 4;

/* 4. –°–æ—Å—Ç–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç —Å–∫–∞–∑–æ—á–Ω—ã–π –≤–∏–¥ (—Å—Ç–∞—Ç—É—Å fairy), –Ω–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π –Ω–∏ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.
–†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –±—É–∫–≤–µ ¬´–¢¬ª.*/

select species_name
from species as s LEFT join (places as p join species_in_places as sip on p.place_id = sip.place_id) as x
on s.species_id=x.species_id
where s.species_status ='fairy' and x.place_name IS NULL;
